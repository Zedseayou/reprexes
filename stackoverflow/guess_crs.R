library(tidyverse)
library(sf)
data <- structure(list(LON = c(3.6189419546606, 3.47346614446389, 3.44239459327957, 3.29350462630471, 3.35268808777572, 3.56791893543689, 3.33366611318681, 3.39473714826007, 3.41056562146275, 3.61392544406354, 3.50258), LAT = c(50.6816466868977, 50.5589876530483, 50.6997902260753, 50.6876572958438, 50.6800941411327, 50.523718459466, 50.5438833669109, 50.6132227223641, 50.5307279235646, 50.5960956577015, 50.7414748843137), x = c(96227.0052771935, 86074.2589595734, 84369.8773101478, 73127.7357132523, 77875.9986049107, 93229.1592839806, 76183.8151614011, 80806.111537044, 82041.2236842105, 96907.4010078463, 88860.5615808823), y = c(152551.212026743, 138702.046875, 154860.466229839, 153413.886429398, 153115.726084184, 134975.700053095, 137373.913804945, 145229.97987092, 135743.853978207, 143057.883184524, 159399.019607843)), class = c("tbl_df", "tbl", "data.frame"), row.names = c(NA, -11L), .Names = c("LON", "LAT", "x", "y"))
epsg_belgium <- c(3447, 3812, 31370, 31300, 21500, 4809, 4313, 4215, 25832, 8370, 6190, 5710, 25831)
guess_crs <- function(tbl, lon_lat, x_y, epsg_codes) {
  wgs84 <- tbl %>%
    st_as_sf(coords = lon_lat, crs = 4326)
  compare_crs <- function(epsg) {
    tbl %>%
      st_as_sf(coords = x_y, crs = epsg) %>%
      st_transform(4326) %>%
      st_distance(wgs84, by_element = TRUE) %>%
      as.numeric %>%
      `^`(2) %>%
      mean %>%
      sqrt
  }
  poss_commpare <- possibly(compare_crs, otherwise = Inf)
  tibble(
    crs = epsg_codes,
    rms_dist = map_dbl(epsg_codes, poss_commpare)
  ) %>%
    arrange(rms_dist)
}
guess_crs(data, c("LON", "LAT"), c("x", "y"), epsg_belgium)
